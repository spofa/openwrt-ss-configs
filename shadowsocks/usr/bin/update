#!/bin/sh

actions=/usr/bin/update-actions
tmpActions=/tmp/update-actions

remoteDir=https://github.com/gnu4cn/openwrt-ss-configs/raw/master/shadowsocks

flag=0

wget -4 --no-check-certificate -O $tmpActions $remoteDir$actions

if [ -e $tmpActions ]; then
    if [ -e $actions ]; then
        oldMd5sum=`md5sum $actions | awk '{print substr($1, 1)}'`
        newMd5sum=`md5sum $tmpActions | awk '{print substr($1, 1)}'`

        if [ $newMd5sum = $oldMd5sum ]; then
            :
        else
            mv $tmpActions $actions
            chmod +x $actions
            eval "$actions" 
            exit 0;
        fi;
    else
        mv $tmpActions $actions
        chmod +x $actions
        eval "$actions"
        exit 0;
    fi;
else
    exit 0;
fi;
